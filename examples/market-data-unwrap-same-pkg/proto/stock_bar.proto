// Example: Unwrap annotation in same package, different file
// This file defines the wrapper message with the unwrap annotation
syntax = "proto3";
package stockdata.v1;

option go_package = "github.com/SebastienMelki/sebuf/examples/market-data-unwrap-same-pkg/generated;stockdata";

import "sebuf/http/annotations.proto";

// StockBar represents a stock OHLCV bar data point.
message StockBar {
  // Timestamp in RFC 3339 format.
  string t = 1 [(sebuf.http.field_examples) = { values: ["2025-12-15T15:05:00Z"] }];
  // Open price.
  double o = 2 [(sebuf.http.field_examples) = { values: ["143.08"] }];
  // High price.
  double h = 3 [(sebuf.http.field_examples) = { values: ["145.00"] }];
  // Low price.
  double l = 4 [(sebuf.http.field_examples) = { values: ["142.50"] }];
  // Close price.
  double c = 5 [(sebuf.http.field_examples) = { values: ["144.25"] }];
  // Volume.
  int64 v = 6 [(sebuf.http.field_examples) = { values: ["1000000"] }];
}

// StockBarsList is a wrapper for a list of bars that will be unwrapped in JSON.
// This enables map values to serialize as arrays instead of nested objects.
//
// IMPORTANT: This message is in a DIFFERENT FILE but SAME PACKAGE as the service
// that uses it. This tests the same-package-different-file unwrap resolution.
message StockBarsList {
  // The bars field is marked for unwrapping - when this message is a map value,
  // the JSON will collapse to just the array: {"AAPL": [...]} instead of {"AAPL": {"bars": [...]}}
  repeated StockBar bars = 1 [(sebuf.http.unwrap) = true];
}
